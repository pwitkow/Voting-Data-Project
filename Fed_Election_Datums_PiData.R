# Title : Federal Election with PI Data

setwd("C:\\Users\\Phillip\\Google Drive\\Where Bais Against Females Berns You - A Study of Implicit Bias and Voting Data\\Data Files\\Fed_Election_Data")
#put whatever libraries here
library('plyr')
library('nlme')
library('ggplot2')
library('Hmisc')
library(broom)

#Functions_________________________________________________________________________________________________________________________

simpleCap <- function(x) {
  s <- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), substring(s, 2),
      sep="", collapse=" ")
}
cleanNames<-function(x){
	s<-gsub("De Witt", "Dewitt", x, fixed=T)
	s<-gsub("Saint ", "St. ", s, fixed=T)
	return(s)
}
addCounty<-function(x){
	d<-paste(x, "County", sep=' ')
	return(d)
}
difGates<-function(x,y, z){
	daters<-MainData[MainData$Count>=20,]
	moodel<-lm(Prop.H~(DScore+(Age+Sex+Asian+Black+Latin+White+EduLevel+Income+Poli+AssoCareer+AssoFamily)),
			data=daters, na.action=na.omit)
	return(coef(summary(moodel))[z,y])
}
	
#data files________________________________________________________________________________________________________________________

#Load the FIPS table and make some adjustments so its standardized with voting data
matchCodes<-read.table("C:\\Users\\Phillip\\Google Drive\\Where Bais Against Females Berns You - A Study of Implicit Bias and Voting Data\\Project Implicit Data\\CountyCodeName.txt",
				sep=",", header=F, quote="", col.names=c("State", "StateEFP", "CountyFP", "CountyName", "ClassFP"))
matchCodes<-as.data.frame(matchCodes)
matchCodes$FIPS<-	#merge state abbv. with county number for FIPS 
	gsub(" ", "",(do.call(paste, as.data.frame(matchCodes[,c(1,3)], stringsAsFactors=FALSE))), fixed=T)
#matchCodes$CountyFP<-ifelse(matchCodes$CountyFP<100 &matchCodes$CountyFP>=10 , paste("0",matchCodes$CountyFP, sep=''),
#				ifelse(matchCodes$CountyFP<10, paste("00",matchCodes$CountyFP, sep=''),
#				matchCodes$CountyFP))
matchCodes$Nums<-gsub(" ", "",(do.call(paste, as.data.frame(matchCodes[,c(2,3)], stringsAsFactors=FALSE))), fixed=T)
matchCodes$CountyName<-as.character(matchCodes$CountyName)
matchCodes$CountyName<-tolower(matchCodes$CountyName)	#lc Everything
matchCodes$CountyName<-unlist(lapply(matchCodes$CountyName,simpleCap)) #UC first letter in each word
matchCodes$CountyName<-unlist(lapply(matchCodes$CountyName,cleanNames))

#AK is all one district
matchCodes[matchCodes$State=='AK',]$FIPS<-matchCodes[matchCodes$State=='AK',]$FIPS[1]
matchCodes[matchCodes$State=='AK',]$Nums<-matchCodes[matchCodes$State=='AK',]$Nums[1]


#Voting data____________________3002-2040____________________________________________________________________________________________

vData<-list.files(pattern='.csv')
vData<-lapply(vData, read.csv, head=T, stringsAsFactors=F)
votData<-do.call(rbind, vData)

#organize a bunch of stuff, like getting rid of commas in numbers, dashes, making captial letters
#are standardized all all that stuff

votData$Popular<-as.integer(votData$Popular)
votData$State=gsub('-'," ", votData$State, fixed=T) #Take Dashes out of names
votData$State<-unlist(lapply(votData$State,simpleCap))#Capitalize First Letter in each name
votData$Place<-as.character(votData$Place)
votData$Place<-tolower(votData$Place) #lc everything 
votData$Place<-gsub("&apos;","'", votData$Place, fixed=T)
votData$Place<-unlist(lapply(votData$Place,simpleCap))	#UC everything in each 


#Convert to Abbvs for codes
votData$State<-state.abb[match(votData$State, state.name)]	

#Clean up some peculiar Crap
votData$Place<-unlist(lapply(votData$Place,cleanNames))	
votData[votData$State=='VA' & votData$Place=='James City',]$Place<-"James City County"
votData[votData$State=='VA' & votData$Place=='Charles City',]$Place<-"Charles City County"


#match state names for FIPS codes
vM <- match(paste(votData$State,votData$Place),
		paste(matchCodes$State,matchCodes$CountyName))
votData$FIPS<-matchCodes$FIPS[vM]
votData$Nums<-matchCodes$Nums[vM]

votData<-votData[!is.na(votData$State),]

#AK is all one district
votData[votData$State=="AK" ,]$FIPS<-matchCodes[matchCodes$State=='AK',]$FIPS[1]
votData[votData$State=="AK",]$Nums<-matchCodes[matchCodes$State=='AK',]$Nums[1]

#IAT Data________________________________________________________________________________________________________________

iatData<-read.csv("C:\\Users\\Phillip\\Google Drive\\Where Bais Against Females Berns You - A Study of Implicit Bias and Voting Data\\Project Implicit Data\\Gender-Career IAT.public.2005-2015.csv", head=T)

#load data into data-frame
iatDataframe<-data.frame(Fin=iatData$session_status, dScore=iatData$D_biep.Male_Career_all,
	Age=iatData$age, year=iatData$year, eduLevel=iatData$edu_14, ethnic=iatData$ethnic, sex=iatData$sex,
	County=iatData$CountyNo, State=iatData$STATE, Income=iatData$anninc, PoliSix=iatData$politicalid_6, 
	PoliSev=iatData$politicalid_7, AssoCareer=iatData$assocareer, AssoFamily=iatData$assofamily, 
	ID=iatData$session_id, Religiosity=iatData$religionid)

#Only use Complete data
iatDataframe<-iatDataframe[iatDataframe$Fin=='C',]


#Dscore becores z-scored
iatDataframe$dScore<-(iatDataframe$dScore-mean(iatDataframe$dScore, 
					na.rm=T))/sd(iatDataframe$dScore, na.rm=T)


#_____Changing age to a z-score_______#
iatDataframe$Age<-(iatDataframe$Age-mean(iatDataframe$Age, 
					na.rm=T))/sd(iatDataframe$Age, na.rm=T)
#______________________________________#

#merge state abbv. with county number for FIPS 
iatDataframe$FIPS<-	
	gsub(" ", "",(do.call(paste, as.data.frame(iatDataframe[,c("State","County")], stringsAsFactors=FALSE))), fixed=T)


#Make all alsaka respondents from the same voting district
iatDataframe[iatDataframe$State=="AK",]$FIPS<-matchCodes[matchCodes$State=='AK',]$FIPS[1]


	#get all the fips that need to be replace

iatDataframe$eduLevel<-ifelse(iatDataframe$eduLevel>=10, 10, iatDataframe$eduLevel)

#_____Changing eduLevel to a z-score_______#
iatDataframe$eduLevel<-(iatDataframe$eduLevel-mean(iatDataframe$eduLevel, 
					na.rm=T))/sd(iatDataframe$eduLevel, na.rm=T)
#__________________________________________#

#_____Changing Income to a z-score_______#
iatDataframe$Income<-(iatDataframe$Income-mean(iatDataframe$Income, 
					na.rm=T))/sd(iatDataframe$Income, na.rm=T)
#__________________________________________#

iatDataframe$Males<-ifelse(iatDataframe$sex=='m', 1,0)
iatDataframe$Females<-ifelse(iatDataframe$sex=='f', 1,0)


#Binary of whether a respondant was part of some race; 1 is yes
# 0 is no
iatDataframe$White<-ifelse(iatDataframe$ethnic==5, 1, 0)
iatDataframe$Black<-ifelse(iatDataframe$ethnic==3, 1, 0)
iatDataframe$Latin<-ifelse(iatDataframe$ethnic==4, 1, 0)
iatDataframe$Asian<-ifelse(iatDataframe$ethnic==2, 1, 0)

#Turn politcal scores into z socre then combine them into new column
meanPoli6<-mean(iatDataframe$PoliSix, na.rm=T)
sdPoli6<-sd(iatDataframe$PoliSix, na.rm=T)

meanPoli7<-mean(iatDataframe$PoliSev, na.rm=T)
sdPoli7<-sd(iatDataframe$PoliSix, na.rm=T)
iatDataframe$PoliScore<-ifelse(is.na(iatDataframe$PoliSix), #if Poli6 has "NA" value
				((iatDataframe$PoliSev-meanPoli7)/sdPoli7),
				((iatDataframe$PoliSix-meanPoli6)/sdPoli6))


#combine explicit measures
iatDataframe$ExpBias<-iatDataframe$AssoCareer-iatDataframe$AssoFamily
iatDataframe$ExpBias<-(iatDataframe$ExpBias-mean(iatDataframe$ExpBias, 
					na.rm=T))/sd(iatDataframe$ExpBias, na.rm=T)

#Transfrom explicit measures into z-scores
iatDataframe$AssoCareer<-(iatDataframe$AssoCareer-mean(iatDataframe$AssoCareer, 
					na.rm=T))/sd(iatDataframe$AssoCareer, na.rm=T) 
iatDataframe$AssoFamily<-(iatDataframe$AssoFamily-mean(iatDataframe$AssoFamily, 
					na.rm=T))/sd(iatDataframe$AssoFamily, na.rm=T)


#standardize relgiosity scores
iatDataframe$Religiosity<-(iatDataframe$Religiosity-mean(iatDataframe$Religiosity, 
					na.rm=T))/sd(iatDataframe$Religiosity, na.rm=T)

#Take out political party if necssary for analysis
#iatDataframe<-iatDataframe[iatDataframe$PoliScore>0,]

#Condense all variables by FIPS
Final<-ddply(iatDataframe, c("FIPS"), summarise, Income=median(Income, na.rm=T),Pop=length(dScore),	     
			     Age=mean(Age, na.rm=T), EduLevel=mean(eduLevel, na.rm=T),
			     Sex=(mean(Females, na.rm=T))/((mean(Females, na.rm=T)+ mean(Males, na.rm=T))),
			     White=mean(White,na.rm=T), Black=mean(Black, na.rm=T), Latin=mean(Latin, na.rm=T),
				Asian=mean(Asian, na.rm=T), Poli=mean(PoliScore, na.rm=T),
				ExpBias_SE=(sd(ExpBias, na.rm=T)/sqrt(Pop)), ExpBias=mean(ExpBias, na.rm=T),
				Exp.FC=mean(AssoFamily, na.rm=T), Exp.MW=mean(AssoCareer, na.rm=T),
				Count=length(FIPS),DScore=mean(dScore, na.rm=T),
			      DScore_SE=(sd(dScore, na.rm=T)/sqrt(Pop)) ) 

#replacements for those with N==1
DScore_SE_Rep=mean(Final$DScore_SE[Final$Pop==2], na.rm=T)
ExpBias_SE_Rep=mean(Final$ExpBias_SE[Final$Pop==2], na.rm=T)

#apply replacements
Final$DScore_SE[Final$Pop==1 | Final$DScore_SE==0 | is.na(Final$DScore_SE)]<-DScore_SE_Rep
Final$ExpBias_SE[Final$Pop==1| Final$ExpBias_SE==0 | is.na(Final$ExpBias_SE)]<-ExpBias_SE_Rep

#weights for Dscore and Exp_Bias
Final$DScore_wieght<-log(1/(Final$DScore_SE^2)) 
Final$ExpBias_wieght<-log(1/(Final$ExpBias_SE^2)) 

Final$weight<-((Final$DScore_wieght+Final$ExpBias_wieght)/2)

#____Percentage of Latin z-Score____
#Final$Latin<-(Final$Latin-mean(Final$Latin, 
#					na.rm=T))/sd(Final$Latin, na.rm=T)
#__________________________________________#

#____ Religion_________________________________________--#
rel_data<-read.csv("C:\\Users\\Phillip\\Google Drive\\Where Bais Against Females Berns You - A Study of Implicit Bias and Voting Data\\rel_data.csv", head=T)
rel_data<-as.data.frame(rel_data)

#get just the necessary variables
rel_data<-rel_data[,c("FIPS", "STNAME", "TOTRATE")]

#get the state Abb's
rel_data$Abb<-state.abb[match(rel_data$STNAME, state.name)]	

#get rid of zeros
rel_data$FIPS<-substring(as.character(rel_data$FIPS),3)
rel_data$FIPS<-as.numeric(rel_data$FIPS)
rel_data$FIPS<-as.character(rel_data$FIPS)

rel_data$FIPS<-
	gsub(" ", "",(do.call(paste, as.data.frame(rel_data[,c(4,1)], stringsAsFactors=FALSE))), fixed=T)

rel_data<-rel_data[complete.cases(rel_data),]
#Turn it into z-scores
rel_data$TOTRATEZ<-(rel_data$TOTRATE-(mean(rel_data$TOTRATE, na.rm=T)))/sd(rel_data$TOTRATE, na.rm=T)


#Modeled Parameters_______________________________________________________
quad_data<-read.csv("C:\\Users\\Phillip\\Google Drive\\Where Bais Against Females Berns You - A Study of Implicit Bias and Voting Data\\quads.csv")
quad_data<-as.data.frame(quad_data)
quad_data$FIPS<-as.character(quad_data$FIPS)


#Doing Stuff__________________________________________________________________________________________________________					
#Main Model data shaping and analysis

#get only trump and hillary data
MainData<-votData[votData$Candidate=='H.Clinton' |votData$Candidate=='D.Trump',-c(1)]

#Reshape to long
MainData<-MainData[ , -which(names(MainData) %in% c("Nums"))]
MainData<-w <- reshape(MainData, timevar = "Candidate",
  idvar = c("State", "Place", "FIPS"),direction = "wide")
MainData$Prop.H<-MainData$Popular.H.Clinton/(MainData$Popular.H.Clinton+MainData$Popular.D.Trump)

#Attach County IAT-Data
mM<-match(MainData$FIPS, Final$FIPS)
rM<-match(MainData$FIPS, rel_data$FIPS)
qM<-match(MainData$FIPS, quad_data$FIPS)

MainData$Income<-Final$Income[mM]
MainData$DScore<-Final$DScore[mM]
MainData$Age<-Final$Age[mM]
MainData$EduLevel<-Final$EduLevel[mM]
MainData$Sex<-Final$Sex[mM]
MainData$White<-Final$White[mM]
MainData$Black<-Final$Black[mM]
MainData$Latin<-Final$Latin[mM]
MainData$Asian<-Final$Asian[mM]
MainData$Poli<-Final$Poli[mM]
MainData$AssoFamily<-Final$AssoFamily[mM]
MainData$AssoCareer<-Final$AssoCareer[mM]
MainData$CheckFIPS<-Final$FIPS[mM]
MainData$Count<-Final$Count[mM]
MainData$Wieght<-Final$weight[mM]
MainData$ExpBias<-Final$ExpBias[mM]
MainData$Exp.FF<-Final$Exp.FC[mM]
MainData$Exp.MW<-Final$Exp.MW[mM]
MainData$Nums<-as.numeric(MainData$Nums)

#Religion
MainData$Religous<-rel_data$TOTRATEZ[rM]


#Remove All Unmatched Counties
MainData<-MainData[!(is.na(MainData$CheckFIPS)),]
#Set cutoff and do statistics stuff
daters<-MainData

#get rid of NA rows 
daters<-daters[rowSums(is.na(daters)) <= 0,]
daters<-daters[complete.cases(daters),]

#is there a faster way to do this using matrix multiplication?
daters<-ddply(daters, c("FIPS", "Prop.H"), summarise, DScore=DScore*Wieght, Age=Age*Wieght,  
			Sex=Sex*Wieght, Asian=Asian*Wieght, Black=Black*Wieght, Latin=Latin*Wieght, 
			White=White*Wieght, EduLevel=EduLevel*Wieght, Income=Income*Wieght,
			Poli=Poli*Wieght, ExpBias=ExpBias*Wieght, Exp.FF=Exp.FF, Exp.MW=Exp.MW, 
			Religous=Religous*Wieght,
			 Wieght=Wieght, num_votes=Popular.H.Clinton+Popular.D.Trump,
			Count=Count)

corTests<-daters[,c(13,3,15, 14, 18, 17, 4, 10, 11, 5,6,7,8,9,12,16)]
#corTest needs to be a matrix
corrs<-rcorr(as.matrix(corTests))$r
ps<-rcorr(as.matrix(corTests))$P


#run the model and save the data
setwd('C:\\Users\\Phillip\\Google Drive\\Where Bais Against Females Berns You - A Study of Implicit Bias and Voting Data\\CombinedBias')
MainModel<-lm(Prop.H~DScore
			+ExpBias
			+Age  #Avg age of county
			+Sex	# % of females
			+Asian #% of Asians
			+Black #% African American
			+Latin #%Latin American	
			+White #% White American
			+EduLevel #Avg Edu level 
			+Income # Avg Income
			+Poli	#Avg political standing
			+Religous,
			data=daters, na.action=na.omit)

summary(MainModel, correlation=F)

df<-tidy(MainModel)

#Coefficeint Comparison?--------------------------------------------------------------------------
#  Not touched yet. Gotta do the plus minus analyses    


f<-daters
sigTestData<-f
sigTestData$ExpBias<-sigTestData$ExpBias*1 #im only suppose to do this with pos predictons
sigTestData$ExpBiasPlus<-(sigTestData$DScore+sigTestData$ExpBias)
sigTestData$ExpBiasMinus<-(sigTestData$DScore-sigTestData$ExpBias)

SigModel<-lm(Prop.H~ExpBiasPlus
			+ExpBiasMinus
			+Age #Avg age of county
			+Sex	# % of females
			+Asian #% of Asians
			+Black#% African American
			+Latin #%Latin American	
			+White #% White American
			+EduLevel #Avg Edu level
			+Income # Avg Income
			+Poli #Avg political standing
			+Religous, #Avg degree of Explicit women-family
			data=sigTestData, na.action=na.omit)
HvTExp<-tidy(SigModel)

sigTestData<-f
sigTestData$Age<-sigTestData$Age*-1 #im only suppose to do this with pos predictons
sigTestData$AgePlus<-(sigTestData$DScore+sigTestData$Age)
sigTestData$AgeMinus<-(sigTestData$DScore-sigTestData$Age)

SigModel<-lm(Prop.H~ExpBias
			+AgePlus
			+AgeMinus #Avg age of county
			+Sex	# % of females
			+Asian #% of Asians
			+Black#% African American
			+Latin #%Latin American	
			+White #% White American
			+EduLevel #Avg Edu level
			+Income # Avg Income
			+Poli #Avg political standing
			+Religous, #Avg degree of Explicit women-family
			data=sigTestData, na.action=na.omit)
HvTAge<-tidy(SigModel)

sigTestData<-f
sigTestData$Sex<-sigTestData$Sex*-1 #im only suppose to do this with pos predictons
sigTestData$SexPlus<-(sigTestData$DScore+sigTestData$Sex)
sigTestData$SexMinus<-(sigTestData$DScore-sigTestData$Sex)

SigModel<-lm(Prop.H~ExpBias
			+Age #Avg age of county
			+SexPlus
			+SexMinus	# % of females
			+Asian #% of Asians
			+Black#% African American
			+Latin #%Latin American	
			+White #% White American
			+EduLevel #Avg Edu level
			+Income # Avg Income
			+Poli #Avg political standing
			+Religous, #Avg degree of Explicit women-family
			data=sigTestData, na.action=na.omit)
HvTSex<-tidy(SigModel)

sigTestData<-f
sigTestData$Asian<-sigTestData$Asian*-1 #im only suppose to do this with pos predictons
sigTestData$AsianPlus<-(sigTestData$DScore+sigTestData$Asian)
sigTestData$AsianMinus<-(sigTestData$DScore-sigTestData$Asian)

SigModel<-lm(Prop.H~ExpBias
			+Age #Avg age of county
			+Sex	# % of females
			+AsianPlus
			+AsianMinus #% of Asians
			+Black#% African American
			+Latin #%Latin American	
			+White #% White American
			+EduLevel #Avg Edu level
			+Income # Avg Income
			+Poli #Avg political standing
			+Religous, #Avg degree of Explicit women-family
			data=sigTestData, na.action=na.omit)
HvTAsian<-tidy(SigModel)

sigTestData<-f
sigTestData$Black<-sigTestData$Black*-1 #im only suppose to do this with pos predictons
sigTestData$BlackPlus<-(sigTestData$DScore+sigTestData$Black)
sigTestData$BlackMinus<-(sigTestData$DScore-sigTestData$Black)

SigModel<-lm(Prop.H~ExpBias
			+Age #Avg age of county
			+Sex	# % of females
			+Asian #% of Asians
			+BlackPlus
			+BlackMinus#% African American
			+Latin #%Latin American	
			+White #% White American
			+EduLevel #Avg Edu level
			+Income # Avg Income
			+Poli #Avg political standing
			+Religous, #Avg degree of Explicit women-family
			data=sigTestData, na.action=na.omit)
HvTBlack<-tidy(SigModel)


sigTestData<-f
sigTestData$Latin<-sigTestData$Latin*-1 #im only suppose to do this with pos predictons
sigTestData$LatinPlus<-(sigTestData$DScore+sigTestData$Latin)
sigTestData$LatinMinus<-(sigTestData$DScore-sigTestData$Latin)

SigModel<-lm(Prop.H~ExpBias
			+Age #Avg age of county
			+Sex	# % of females
			+Asian #% of Asians
			+Black#% African American
			+LatinPlus
			+LatinMinus #%Latin American	
			+White #% White American
			+EduLevel #Avg Edu level
			+Income # Avg Income
			+Poli #Avg political standing
			+Religous, #Avg degree of Explicit women-family
			data=sigTestData, na.action=na.omit)
HvTLatin<-tidy(SigModel)




sigTestData<-f
sigTestData$White<-sigTestData$White*-1 #im only suppose to do this with pos predictons
sigTestData$WhitePlus<-(sigTestData$DScore+sigTestData$White)
sigTestData$WhiteMinus<-(sigTestData$DScore-sigTestData$White)

SigModel<-lm(Prop.H~ExpBias
			+Age #Avg age of county
			+Sex	# % of females
			+Asian #% of Asians
			+Black#% African American
			+Latin #%Latin American	
			+WhitePlus
			+WhiteMinus #% White American
			+EduLevel #Avg Edu level
			+Income # Avg Income
			+Poli #Avg political standing
			+Religous, #Avg degree of Explicit women-family
			data=sigTestData, na.action=na.omit)
HvTWhite<-tidy(SigModel)

sigTestData<-f
sigTestData$EduLevel<-sigTestData$EduLevel*-1 #im only suppose to do this with pos predictons
sigTestData$EduLevelPlus<-(sigTestData$DScore+sigTestData$EduLevel)
sigTestData$EduLevelMinus<-(sigTestData$DScore-sigTestData$EduLevel)

SigModel<-lm(Prop.H~ExpBias
			+Age #Avg age of county
			+Sex	# % of females
			+Asian #% of Asians
			+Black#% African American
			+Latin #%Latin American	
			+White #% White American
			+EduLevelPlus
			+EduLevelMinus #Avg Edu level
			+Income # Avg Income
			+Poli #Avg political standing
			+Religous, #Avg degree of Explicit women-family
			data=sigTestData, na.action=na.omit)
HvTEdu<-tidy(SigModel)


sigTestData<-f
sigTestData$Income<-sigTestData$Income*-1 #im only suppose to do this with pos predictons
sigTestData$IncomePlus<-(sigTestData$DScore+sigTestData$Income)
sigTestData$IncomeMinus<-(sigTestData$DScore-sigTestData$Income)

SigModel<-lm(Prop.H~ExpBias
			+Age #Avg age of county
			+Sex	# % of females
			+Asian #% of Asians
			+Black#% African American
			+Latin #%Latin American	
			+White #% White American
			+EduLevel #Avg Edu level
			+IncomePlus
			+IncomeMinus # Avg Income
			+Poli #Avg political standing
			+Religous, #Avg degree of Explicit women-family
			data=sigTestData, na.action=na.omit)
HvTInc<-tidy(SigModel)

sigTestData<-f
sigTestData$Poli<-sigTestData$Poli*-1 #im only suppose to do this with pos predictons
sigTestData$PoliPlus<-(sigTestData$DScore+sigTestData$Poli)
sigTestData$PoliMinus<-(sigTestData$DScore-sigTestData$Poli)

SigModel<-lm(Prop.H~ExpBias
			+Age #Avg age of county
			+Sex	# % of females
			+Asian #% of Asians
			+Black#% African American
			+Latin #%Latin American	
			+White #% White American
			+EduLevel #Avg Edu level
			+Income # Avg Income
			+PoliPlus
			+PoliMinus #Avg political standing
			+Religous, #Avg degree of Explicit women-family
			data=sigTestData, na.action=na.omit)
HvTPoli<-tidy(SigModel)

sigTestData<-f
#sigTestData$Religous<-sigTestData$Religous*-1 #im only suppose to do this with pos predictons
sigTestData$ReligousPlus<-(sigTestData$DScore+sigTestData$Religous)
sigTestData$ReligousMinus<-(sigTestData$DScore-sigTestData$Religous)

SigModel<-lm(Prop.H~ExpBias
			+Age #Avg age of county
			+Sex	# % of females
			+Asian #% of Asians
			+Black#% African American
			+Latin #%Latin American	
			+White #% White American
			+EduLevel #Avg Edu level
			+Income # Avg Income
			+Poli #Avg political standing
			+ReligousPlus
			+ReligousMinus,
			data=sigTestData, na.action=na.omit)
HvTRel<-tidy(SigModel)

total<-rbind(HvTExp, HvTAge, HvTSex, HvTAsian, HvTBlack, HvTLatin, HvTWhite, 
		HvTEdu, HvTInc, HvTPoli, HvTRel)









test<-Final[!(Final$FIPS %in% unique(MainData$FIP)),] 